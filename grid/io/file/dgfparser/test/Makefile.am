GRIDTYPE = DEFAULTGRID
GRIDDIM = 2

LDADD = $(ALL_PKG_LDFLAGS) $(ALL_PKG_LIBS) $(MPI_LDFLAGS)
AM_CPPFLAGS =  @AM_CPPFLAGS@ $(ALL_PKG_CPPFLAGS) -D$(GRIDTYPE) $(UG_CPPFLAGS)

if ALUGRID
  TESTALU = testalu
endif

if ALBERTA
  TESTALBERTA = testalberta
endif

if UG
  TESTUG = testug
endif

ALLTESTS = $(TESTALU) $(TESTALBERTA) testsgrid testyasp testoned $(TESTUG)

# programs just to build when "make check" is used
check_PROGRAMS = $(ALLTESTS)

# list of tests to run
TESTS = $(ALLTESTS)

# test program for all tpyes of grids
noinst_PROGRAMS = tester

tester_SOURCES = main.cc
tester_CXXFLAGS = -g -DGRIDDIM=GRIDDIM -DGRIDDIMWORLD=GRIDDIM $(AM_CPPFLAGS) $(ALBERTA_CPPFLAGS) $(GRAPE_CPPFLAGS) $(ALUGRID_CPPFLAGS) $(UG_CPPFLAGS)
tester_LDADD = $(LOCAL_LIBS) $(ALBERTA_LDFLAGS) $(ALBERTA_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(ALUGRID_LDFLAGS) $(ALUGRID_LIBS) $(MPI_LDFLAGS) $(UG_LIBS) $(UG_LDFLAGS)
tester_DEPENDENCIES = $(LOCAL_LIBS)

if ALUGRID
testalu_CXXFLAGS = $(AM_CPPFLAGS) -DALUGRID_SIMPLEX -DGRIDDIM=3 $(MPI_CPPFLAGS)
testalu_SOURCES = testalu.cc
testalu_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(ALUGRID_LDFLAGS) $(ALUGRID_LIBS) $(MPI_LDFLAGS) $(MPILIBS)
testalu_DEPENDENCIES = $(LOCAL_LIBS)
endif

if ALBERTA
testalberta_CXXFLAGS = $(AM_CPPFLAGS) -DGRIDDIM=$(ALBERTA_DIM)
testalberta_SOURCES = testalberta.cc
testalberta_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(ALBERTA_LDFLAGS) $(ALBERTA_LIBS)
testalberta_DEPENDENCIES = $(LOCAL_LIBS)
endif

testsgrid_CXXFLAGS = $(AM_CPPFLAGS)
testsgrid_SOURCES = testsg.cc
testsgrid_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS)
testsgrid_DEPENDENCIES = $(LOCAL_LIBS)

testyasp_CXXFLAGS = $(AM_CPPFLAGS)
testyasp_SOURCES = testyasp.cc
testyasp_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS)
testyasp_DEPENDENCIES = $(LOCAL_LIBS)

testoned_CXXFLAGS = $(AM_CPPFLAGS)
testoned_SOURCES = testoned.cc
testoned_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS)
testoned_DEPENDENCIES = $(LOCAL_LIBS)

if UG
testug_CXXFLAGS = $(AM_CPPFLAGS)
testug_SOURCES = testug.cc
testug_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(UG_LDFLAGS) $(UG_LIBS)
testug_DEPENDENCIES = $(LOCAL_LIBS)
endif

include $(top_srcdir)/am/global-rules
