GRIDTYPE = DEFAULTGRID
DUNE_WORLD_DIM = $(DUNE_PROBLEM_DIM)

LDADD = $(ALL_PKG_LDFLAGS) $(ALL_PKG_LIBS) $(MPI_LDFLAGS)
AM_CPPFLAGS =  @AM_CPPFLAGS@ $(ALL_PKG_CPPFLAGS) -D$(GRIDTYPE) -DGRIDDIM=$(DUNE_PROBLEM_DIM) -DGRIDDIMWORLD=$(DUNE_WORLD_DIM) $(MPI_CPPFLAGS) $(UG_CPPFLAGS)

if ALUGRID
 TESTALU = testalu
endif

if ALBERTA
  TESTALBERTA = testalberta
endif

if UG
  TESTUG = testug
endif

check_PROGRAMS = tester $(TESTALU) $(TESTALBERTA) testsgrid testyasp testoned $(TESTUG)

tester_SOURCES = main.cc
tester_CXXFLAGS = $(AM_CPPFLAGS) $(ALBERTA_CPPFLAGS) $(GRAPE_CPPFLAGS) $(ALUGRID_CPPFLAGS) $(UG_CPPFLAGS)
tester_LDADD = $(LOCAL_LIBS) $(ALBERTA_LDFLAGS) $(ALBERTA_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(ALUGRID_LDFLAGS) $(ALUGRID_LIBS) $(MPI_LDFLAGS) $(UG_LIBS) $(UG_LDFLAGS)
tester_DEPENDENCIES = $(LOCAL_LIBS)

if ALUGRID
testalu_CXXFLAGS = $(AM_CPPFLAGS) -DALUGRID_SIMPLEX -DGRIDDIM=3
testalu_SOURCES = main.cc
testalu_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(ALUGRID_LDFLAGS) $(ALUGRID_LIBS) $(MPI_LDFLAGS) $(MPILIBS)
testalu_DEPENDENCIES = $(LOCAL_LIBS)
endif

if ALBERTA
testalberta_CXXFLAGS = $(AM_CPPFLAGS) -DALBERTAUGRID -DGRIDDIM=2
testalberta_SOURCES = main.cc
testalberta_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(ALBERTA_LDFLAGS) $(ALBERTA_LIBS)
testalberta_DEPENDENCIES = $(LOCAL_LIBS)
endif

testsgrid_CXXFLAGS = $(AM_CPPFLAGS) -DSGRID -DGRIDDIM=2
testsgrid_SOURCES = main.cc
testsgrid_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS)
testsgrid_DEPENDENCIES = $(LOCAL_LIBS)

testyasp_CXXFLAGS = $(AM_CPPFLAGS) -DYASPGRID -DGRIDDIM=2
testyasp_SOURCES = main.cc
testyasp_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS)
testyasp_DEPENDENCIES = $(LOCAL_LIBS)

testoned_CXXFLAGS = $(AM_CPPFLAGS) -DONEDGRID -DGRIDDIM=1
testoned_SOURCES = main.cc
testoned_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS)
testoned_DEPENDENCIES = $(LOCAL_LIBS)

if UG
testug_CXXFLAGS = $(AM_CPPFLAGS) -DUGGRID -DGRIDDIM=3
testug_SOURCES = main.cc
testug_LDADD = $(LOCAL_LIBS) $(GRAPE_LIBS) $(GRAPE_LDFLAGS) $(MPI_LDFLAGS) $(UG_LDFLAGS) $(UG_LIBS)
testug_DEPENDENCIES = $(LOCAL_LIBS)
endif


